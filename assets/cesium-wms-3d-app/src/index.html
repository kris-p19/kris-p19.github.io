<!DOCTYPE html>
<html>

<head>
    <title>OL-Cesium - Custom Projection (EPSG:4326)</title>
    <meta charset="utf-8" />

    <script src="https://unpkg.com/ol@latest/dist/ol.js"></script>
    <link href="https://unpkg.com/ol@latest/ol.css" rel="stylesheet" />

    <script src="https://unpkg.com/ol-cesium@latest/dist/olcesium.js"></script>
    <script src="https://unpkg.com/proj4@2.8.0/dist/proj4.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Cesium.js"></script>
    <style>
        html,
        body,
        #map {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
        }
        #toggle-3d {
            position: absolute;
            top: 10px;
            left: 40px;
            z-index: 1000;
            padding: 10px;
            background-color: white;
            border: 1px solid #ccc;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <button id="toggle-3d">Toggle 3D</button>
    <div id="map" class="map"></div>
    <script>
        // Register projection (EPSG:4326)
        ol.proj.proj4.register(proj4);
        const proj4326 = ol.proj.get('EPSG:4326');

        // Base layer using OSM
        const osmLayer = new ol.layer.Tile({
            source: new ol.source.OSM()
        });

        // View with EPSG:4326
        const view = new ol.View({
            projection: proj4326,
            center: [100.5018, 13.7563], // LonLat (Bangkok)
            zoom: 1
        });

        const vectorSource = new ol.source.Vector({
            url: 'shoreline_0m4326.geojson', // ðŸ” Your file path here
            format: new ol.format.GeoJSON()
        });

        const vectorLayer = new ol.layer.Vector({
            source: vectorSource,
            style: new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: 'red',
                    width: 2
                })
            })
        });

        const map = new ol.Map({
            target: 'map',
            layers: [osmLayer, vectorLayer],
            view: view
        });

        // Enable OL-Cesium 3D
        const ol3d = new olcs.OLCesium({ map: map });
        const scene = ol3d.getCesiumScene();
        scene.globe.depthTestAgainstTerrain = true;
        ol3d.setEnabled(false); // à¹€à¸›à¸´à¸”à¹‚à¸«à¸¡à¸” 3D

        // Modify à¹€à¸ªà¹‰à¸™
        const modify = new ol.interaction.Modify({ source: vectorSource });
        map.addInteraction(modify);

        // Select à¹€à¸ªà¹‰à¸™à¹€à¸žà¸·à¹ˆà¸­à¸£à¸­à¸à¸²à¸£à¸¥à¸š
        const select = new ol.interaction.Select();
        map.addInteraction(select);

        // à¸¥à¸š feature à¹€à¸¡à¸·à¹ˆà¸­à¸à¸”à¸›à¸¸à¹ˆà¸¡ Delete
        document.addEventListener('keydown', function (evt) {
            if (evt.key === 'Delete') {
                const selected = select.getFeatures();
                selected.forEach(f => vectorSource.removeFeature(f));
                selected.clear();
            }
        });

        document.getElementById('toggle-3d').addEventListener('click', function () {
            ol3d.setEnabled(!ol3d.getEnabled());
            this.textContent = ol3d.getEnabled() ? 'Disable 3D' : 'Enable 3D';
        });
    </script>
</body>

</html>